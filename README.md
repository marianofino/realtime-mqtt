# Instructions

## Requirements

* Node.js (tested with v10.14.1): https://nodejs.org/es/download/

## Running the examples

### Merging 2 topics

In this example, there are 2 publishers sending messages with a different topic each, "pressure" and "temperature", and one subscriber subscribed to a third topic, "kConstant". The broker receives the topics published, processes them, and publishes a the topic expected by the subscriber. To run this example follow these steps:

1. On the root folder, run:

```
$ npm rebuild
```

2. Go to examples/merging-2-topics

3. Open a terminal and run the broker:

```
$ node broker.js
```

4. Open another terminal and run the subscriber:

```
$ node subscriber.js
```

5. Open another terminal and run one publisher:

```
$ node sensor1_temperature.js
```

6. Open another terminal and run the other publisher:

```
$ node sensor2_pressure.js
```

7. Every minute you should see at the subscriber terminal that the message generated by the broker is received.

#### How to test IRTA?

In the example folder, open `broker.js` in a text editor. Locate function definition *lambda* (line 32 approx). That function acts as a filter of all the incoming packets to the broker. By redefining that function you can add your own logic, store/delete data from the packets, etc. If that function returns true, it will publish that packet; if it returns false, it will not publish it.

If you would like to test the time constraints introduced in IRTA model, you must change the *subscriber* and *publisher* **topicParams** located on the respective files.

# Troubleshooting

## Error: listen EADDRINUSE :::1883

This means that the port 1883 is being used by other process. Probably you have another MQTT broker running (Mosquitto?). Make sure to either stop that process or change the broker port (found on `settings` in the broker file).
